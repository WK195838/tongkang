     H*****************************************************************
     H*
     H*               >>   PROGRAM INTRODUCTION   <<
     H*
     H*            1.PROGRAM-ID    ARP051R1
     H*            2.PROGRAM-TYPE  RPG/400
     H*            3.AUTHOR        S02CLJ
     H*            4.FUNCTION     日期客戶別磅單重量差異分析（地磅重）
     H*            5.DATE-WRITTEN  86/04/26
     H*
     H*****************************************************************
     H        1   Y                                     1                 BR003
     FWTMASPJ1IP  E           K        DISK
     FARP051F O   E           K        DISK
     FARP051FOIF  E           K        DISK
     F*****************************************************************
     IRWTMASPJ
     I                                              W6CUNOL5
     I                                              W6ORNOL4
     I                                              W6AREAL3
     I                                              W6VNO2L2
     I                                              W6VNO2L1
     I*----------------------------------------------------------------
     I           UDS
     I                                     10011010 U#USID
     I                                     10211021 U#AREA
     I            DS
     I                                        1   2 W6TRCD
     I                                        1   1 W#IO
     I            DS
     I                                        1   1 W6AREA
     I                                        2   60W6VNO2
     I                                        1   6 W#WTNO
     C*****************************************************************
     C*        主程式開始
     C*****************************************************************
     C  N99                EXSR INISR
     C  N99                SETON                     99
     C   L5                EXSR L5CLR
     C   L1 33             EXSR L1CLR
     C      33             EXSR DTLSR
     CL1 99 33             EXSR L1SR
     CLR 99                EXSR LRSR
     CLRN99                EXSR MSGSR
     C*
     C*********************************
     C*  初始程式
     C*********************************
     CSR         INISR     BEGSR
     C                     Z-ADD0         W#PDWT 120       地磅重量
     CSR                   ENDSR
     C*
     C*********************************
     C*  L5清除函式
     C*********************************
     CSR         L5CLR     BEGSR
     C           W6CUNO    CHAINWXREC                69
     C           *IN69     IFEQ '0'
     C                     SETON                     33    計算該客戶
     C                     ELSE
     C                     SETOF                     33    忽略該客戶
     C                     ENDIF
     CSR                   ENDSR
     C*
     C*********************************
     C*  L1清除函式
     C*********************************
     CSR         L1CLR     BEGSR
     C                     Z-ADD0         W#PDWT           地磅重量
     CSR                   ENDSR
     C*
     C*********************************
     C*  DETAIL TIME 函式
     C*********************************
     CSR         DTLSR     BEGSR
     C           W#IO      IFEQ '1'                        出貨類
     C           W6TYPE    IFEQ '0'
     C                     ADD  W7STDW    W#PDWT           理論重
     C                     ELSE
     C                     ADD  W7NWGT    W#PDWT           實重
     C                     ENDIF
     C*
     C                     ELSE                            退貨類
     C           W6TYPE    IFEQ '0'
     C                     SUB  W7STDW    W#PDWT           理論重
     C                     ELSE
     C                     SUB  W7NWGT    W#PDWT           實重
     C                     ENDIF
     C                     ENDIF
     CSR                   ENDSR
     C*
     C*********************************
     C*  L1 函式  存檔
     C*********************************
     CSR         L1SR      BEGSR
     C                     CLEARWDREC
     C                     MOVELW6CUNO    WDCUNO
     C                     MOVELW6ORNO    WDORNO
     C                     MOVELW#WTNO    WDWTNO
     C                     MOVELW6VNO1    WDVNO1
     C                     MOVELW6GROP    WDGROP
     C                     MOVELW6TRCD    WDTRCD
     C                     Z-ADDW#PDWT    WDPDWT
     C                     WRITEWDREC
     CSR                   ENDSR
     C*
     C*********************************
     C*  LR 函式  印核覆
     C*********************************
     CSR         LRSR      BEGSR
     CSR                   ENDSR
     C*
     C*********************************
     C*  查無資料函式
     C*********************************
     CSR         MSGSR     BEGSR
     C*                    WRITEAR051T1H
     C*                    WRITEAR051T1M
     CSR                   ENDSR
     C*
     C*********************************
     C*  子函式集
     C*********************************
