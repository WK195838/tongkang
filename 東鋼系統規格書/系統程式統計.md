# 東鋼應收帳款系統 - 程式數量統計

## 系統程式數量摘要

| 程式類型 | 基本程式數量 | 含修訂版總數 | 百分比 | 需撰寫規格書數量 |
|---------|------------|------------|--------|--------------------|
| **RPG程式** | 約420 | 2962 | 50.3% | 2962 |
| **DDS檔案** | 約860 | 1606 | 27.3% | 1606 |
| **CL程式** | 約596 | 1344 | 22.4% | 1344 |
| **總計** | **約1876** | **5912** | **100%** | **5912** |

## 規格書撰寫說明
根據專案需求，所有程式檔案（包括各修訂版本）均需納入規格書撰寫範圍。這意味著即使是修訂版程式，也需要建立完整的程式規格說明文件。由於東鋼應收帳款系統歷經多年發展，修訂版程式可能包含特定業務邏輯與功能，因此完整記錄所有程式版本有助於系統維護與未來升級。

## 各類程式數量明細

### 1. RPG程式數量

| 程式類型 | 基本程式數量 | 含修訂版總數 | 需撰寫規格書數量 |
|---------|------------|------------|-----------------|
| ARS系列 (應收帳款處理) | 6 | 10 | 10 |
| ARR系列 (應收帳款報表) | 約110 | 1029 | 1029 |
| CNV系列 (資料轉換) | 12 | 51 | 51 |
| ARP系列 (列印相關) | 約160 | 1084 | 1084 |
| ARE系列 (編輯處理) | 約100 | 730 | 730 |
| 其他程式 | 約32 | 58 | 58 |
| **RPG程式總計** | **約420** | **2962** | **2962** |

### 2. DDS檔案數量

| 檔案類型 | 基本檔案數量 | 含修訂版總數 | 需撰寫規格書數量 |
|---------|------------|------------|-----------------|
| ARR系列 (報表相關) | 約320 | 602 | 602 |
| ARE系列 (編輯相關) | 約200 | 364 | 364 |
| ARP系列 (列印相關) | 約110 | 194 | 194 |
| INE/INV系列 (發票相關) | 約60 | 102 | 102 |
| ARS系列 (處理相關) | 約30 | 47 | 47 |
| TRN系列 (交易相關) | 約25 | 40 | 40 |
| RCV/SAR系列 (收據相關) | 約25 | 39 | 39 |
| 其他DDS檔案 | 約90 | 218 | 218 |
| **DDS檔案總計** | **約860** | **1606** | **1606** |

### 3. CL程式數量

| 程式類型 | 基本程式數量 | 含修訂版總數 | 需撰寫規格書數量 |
|---------|------------|------------|-----------------|
| ARP系列 (列印相關) | 估計270 | 625 | 625 |
| ARR系列 (報表產生) | 估計210 | 477 | 477 |
| ARE系列 (編輯處理) | 估計60 | 130 | 130 |
| CNV系列 (資料轉換) | 估計20 | 45 | 45 |
| ARS系列 (處理程式) | 估計15 | 28 | 28 |
| 其他控制程式 | 估計21 | 39 | 39 |
| **CL程式總計** | **約596** | **1344** | **1344** |

## 系統架構特性

1. **修訂版佔比**：
   - RPG程式中的修訂版佔總數的85.8%
   - DDS檔案中的修訂版佔總數的46.3%
   - CL程式中的修訂版佔總數的55.7%
   - 全系統修訂版佔比約68.2%，顯示系統經過多次修改與優化

2. **功能分布**：
   - 列印相關功能：約1903個程式 (32.2%)
   - 應收帳款報表功能：約2108個程式 (35.7%)
   - 編輯處理功能：約1224個程式 (20.7%)
   - 資料轉換功能：約96個程式 (1.6%)
   - 應收帳款處理功能：約85個程式 (1.4%)
   - 其他功能程式：約496個程式 (8.4%)

3. **程式大小分布**（估計值）：
   - 小型程式 (< 5KB): 約2300個 (38.9%)
   - 中型程式 (5KB-15KB): 約3100個 (52.4%)
   - 大型程式 (> 15KB): 約512個 (8.7%)

4. **系統複雜度評估**（估計值）：
   - 高複雜度程式: 約1350個 (22.8%)
   - 中複雜度程式: 約3800個 (64.3%)
   - 低複雜度程式: 約762個 (12.9%)

## 規格書開發規劃

面對近6000個程式檔案，規格書開發將採用以下階段性策略：

1. **第一階段（基礎核心）**：
   - 優先撰寫基本程式的規格書（約1876個檔案）
   - 這些程式是各修訂版本的基礎，優先完成可建立系統基本框架

2. **第二階段（重要修訂版）**：
   - 撰寫重要功能的修訂版規格書
   - 包含已知在生產環境中使用的關鍵修訂版程式

3. **第三階段（完整覆蓋）**：
   - 完成所有剩餘修訂版的規格書
   - 確保整個系統的完整文件覆蓋

所有程式（含修訂版）的規格書將具備相同的詳細程度和文件標準。

## 系統檔案與資料庫

1. **檔案結構**：
   - 主要實體檔案: 約1460個
   - 索引與邏輯檔案: 約132個
   - 顯示檔案: 約12個
   - 工作檔案: 約2個

2. **資料處理流程**：
   - 列印處理程式: 約1903個 (32.2%)
   - 報表產生程式: 約2108個 (35.7%)
   - 編輯處理程式: 約1224個 (20.7%)
   - 其他處理程式: 約677個 (11.4%)

## 備註
1. 系統代碼數量統計根據QRPGSRC_ARLIB、QDDSSRC_ARLIB及QCLSRC_ARLIB資料夾內容
2. QRPGSRC_ARLIB目錄包含2962個RPG程式檔案
3. QDDSSRC_ARLIB目錄包含1606個DDS檔案
4. QCLSRC_ARLIB目錄包含1344個CL程式檔案
5. 所有程式檔案（包括修訂版）均需納入規格書撰寫範圍
6. 系統中大多數程式有多個不同修訂版本，反映長期持續的系統演進
7. 系統總檔案數量達5912個，顯示這是一個非常大型的AS/400應用系統
8. 各類型程式中修訂版佔比：RPG程式85.8%、DDS檔案46.3%、CL程式55.7% 