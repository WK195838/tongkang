# 東鋼應收帳款系統 - CL程式清單

## 系統概述
東鋼應收帳款系統是以 IBM AS/400 傳統 RPG 固定格式開發的系統，主要負責應收帳款管理、電子發票狀態查詢及列印、報表產生等功能。本文件列出系統中的控制語言程式 (CL)，經過詳細分析，實際上系統中共有1344個CL程式檔案，是系統中重要的控制元件。根據專案要求，所有CL程式檔案（包括修訂版本）均需納入規格書撰寫範圍。

## 規格書狀態追蹤說明
為有效追蹤規格書撰寫進度，本清單在每個CL程式項目中增加「規格書狀態」欄位。請依照以下狀態標記進行更新：
- **未開始**：尚未開始撰寫規格書
- **進行中**：規格書撰寫中，但尚未完成
- **已完成**：規格書已完成並經審核
- **已更新**：原規格書已因程式修改而更新

每完成一個CL程式的規格書，請在清單中更新其狀態，以便追蹤整體進度。

## CL程式統計資料

### 主要CL程式類型分佈

| 程式分類 | 數量 | 百分比 | 需撰寫規格書數量 | 已完成數量 | 完成率 |
|---------|------|-------|-----------------|----------|--------|
| 列印控制程式 (ARP系列) | 625 | 46.5% | 625 | 0 | 0% |
| 報表控制程式 (ARR系列) | 477 | 35.5% | 477 | 0 | 0% |
| 編輯控制程式 (ARE系列) | 130 | 9.7% | 130 | 0 | 0% |
| 資料轉換控制程式 (CNV系列) | 45 | 3.3% | 45 | 0 | 0% |
| 應收帳款控制程式 (ARS系列) | 28 | 2.1% | 28 | 0 | 0% |
| 其他控制程式 | 39 | 2.9% | 39 | 0 | 0% |
| **總計** | **1344** | **100%** | **1344** | **0** | **0%** |

### 程式修訂版本統計

| 檔案版本 | 數量 | 百分比 | 需撰寫規格書數量 |
|---------|------|-------|-----------------|
| 基本檔案 (無特殊標記) | 596 | 44.3% | 596 |
| 修訂版檔案 (含@或#標記) | 748 | 55.7% | 748 |
| **總計** | **1344** | **100%** | **1344** |

## 規格書撰寫說明
鑑於CL程式是東鋼應收帳款系統運作的關鍵元件，所有CL程式（包括各種修訂版本）均需撰寫完整的規格書。修訂版本的CL程式可能包含特定業務邏輯與控制流程，因此完整記錄這些修訂版有助於系統維護與未來升級。規格書將包括程式功能說明、參數設定、執行流程、呼叫關係及重要備註等內容。

## 1. 應收帳款控制程式 (ARS系列)
ARS系列共28個檔案，佔CL程式總數的2.1%，主要用於控制應收帳款系統的核心功能。下表列出部分代表性程式：

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 |
|---------|---------|------|---------|---------|----------|
| ARS000P | 1.4KB | 30 | 應收帳款程式控制 | 中 | 未開始 |
| ARS010P | 896B | 20 | 應收帳款程式控制 | 低 | 未開始 |
| ARS020P | 1.2KB | 25 | 應收帳款程式控制 | 中 | 未開始 |
| ARS021P | 585B | 15 | 應收帳款程式控制 | 低 | 未開始 |
| ARS030P | 1.2KB | 25 | 應收帳款程式控制 | 中 | 未開始 |
| ARS090P | 2.2KB | 45 | 應收帳款程式控制 | 中 | 未開始 |
| ARS090P@ | 1.6KB | 35 | 應收帳款程式控制（修訂版） | 中 | 未開始 |
| ARS140P | 791B | 18 | 應收帳款程式控制 | 低 | 未開始 |
| ARS140P@ | 791B | 18 | 應收帳款程式控制（修訂版） | 低 | 未開始 |
| ARS777P | 2.0KB | 45 | 應收帳款程式控制 | 中 | 未開始 |
| ARS888P | 2.0KB | 45 | 應收帳款程式控制 | 中 | 未開始 |

## 2. 報表控制程式 (ARR系列)
ARR系列共477個檔案，佔CL程式總數的35.5%，主要用於控制報表產生功能。下表列出部分代表性程式：

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 |
|---------|---------|------|---------|---------|----------|
| ARR135P | 4.2KB | 95 | 應收帳款報表控制程式 | 中 | 未開始 |
| ARR136P | 8.0KB | 175 | 應收帳款報表控制程式 | 高 | 未開始 |
| ARR136P@ | 6.9KB | 150 | 應收帳款報表控制程式（修訂版） | 高 | 未開始 |
| ARR136P@1 | 7.8KB | 165 | 應收帳款報表控制程式（修訂版） | 高 | 未開始 |
| ARR136P@99 | 8.3KB | 180 | 應收帳款報表控制程式（修訂版） | 高 | 未開始 |
| ARR137P | 6.2KB | 140 | 應收帳款報表控制程式 | 高 | 未開始 |
| ARR138P | 6.1KB | 135 | 應收帳款報表控制程式 | 高 | 未開始 |
| ARR138P@ | 6.1KB | 135 | 應收帳款報表控制程式（修訂版） | 高 | 未開始 |
| ARR142P | 8.5KB | 187 | 發票開立狀況統計報表控制程式 | 高 | 未開始 |
| ARR142P@ | 4.2KB | 95 | 發票開立狀況統計報表控制程式（修訂版） | 中 | 未開始 |
| ARR142P@1 | 5.0KB | 110 | 發票開立狀況統計報表控制程式（修訂版） | 中 | 未開始 |
| ARR142P@2 | 5.3KB | 115 | 發票開立狀況統計報表控制程式（修訂版） | 中 | 未開始 |
| ARR142P@3 | 6.4KB | 140 | 發票開立狀況統計報表控制程式（修訂版） | 高 | 未開始 |
| ARR142P@8 | 8.3KB | 180 | 發票開立狀況統計報表控制程式（修訂版） | 高 | 未開始 |

## 3. 列印控制程式 (ARP系列)
ARP系列共625個檔案，佔CL程式總數的46.5%，是數量最多的CL程式類型，主要用於控制各種列印功能。由於數量龐大，此處僅列出少數代表性程式。

| 程式代號 | 檔案大小 | 估計行數 | 功能簡述 | 複雜度 | 規格書狀態 |
|---------|---------|---------|---------|---------|----------|
| ARP001P | 估計2.5KB | 估計60 | 列印控制程式 | 中 | 未開始 |
| ARP010P | 估計2.3KB | 估計55 | 列印控制程式 | 中 | 未開始 |
| ARP025P | 估計2.8KB | 估計65 | 列印控制程式 | 中 | 未開始 |
| ARP050P | 估計3.2KB | 估計75 | 列印控制程式 | 中 | 未開始 |
| ARP100P | 估計4.0KB | 估計90 | 列印控制程式 | 中 | 未開始 |

## 4. 編輯控制程式 (ARE系列)
ARE系列共130個檔案，佔CL程式總數的9.7%，主要用於控制資料編輯功能。

| 程式代號 | 檔案大小 | 估計行數 | 功能簡述 | 複雜度 | 規格書狀態 |
|---------|---------|---------|---------|---------|----------|
| ARE001P | 估計2.0KB | 估計50 | 編輯控制程式 | 中 | 未開始 |
| ARE010P | 估計2.2KB | 估計55 | 編輯控制程式 | 中 | 未開始 |
| ARE050P | 估計2.5KB | 估計60 | 編輯控制程式 | 中 | 未開始 |

## 5. 資料轉換控制程式 (CNV系列)
CNV系列共45個檔案，佔CL程式總數的3.3%，主要用於控制資料轉換功能。下表列出部分代表性程式：

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 |
|---------|---------|------|---------|---------|----------|
| CNV001P | 1.3KB | 27 | 資料轉換控制程式 | 中 | 未開始 |
| CNV002P | 1.3KB | 28 | 資料轉換控制程式 | 中 | 未開始 |
| CNV013P | 730B | 16 | 資料轉換控制程式 | 低 | 未開始 |
| CNV013P1 | 17KB | 354 | 資料轉換控制程式 | 高 | 未開始 |
| CNV013P1@ | 8.9KB | 198 | 資料轉換控制程式（修訂版） | 高 | 未開始 |
| CNV013P1#1 | 17KB | 349 | 資料轉換控制程式（特別版） | 高 | 未開始 |
| CNV013P1@X | 3.0KB | 63 | 資料轉換控制程式（X修訂版） | 中 | 未開始 |
| CNV013P1@E | 16KB | 347 | 資料轉換控制程式（E修訂版） | 高 | 未開始 |
| CNV030P | 3.5KB | 73 | 資料轉換控制程式 | 中 | 未開始 |
| CNV030P@ | 3.0KB | 61 | 資料轉換控制程式（修訂版） | 中 | 未開始 |
| CNV030P@3 | 3.5KB | 73 | 資料轉換控制程式（修訂版） | 中 | 未開始 |

## 6. 其他控制程式
系統中還有約39個其他類型的控制程式，佔CL程式總數的2.9%。

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 |
|---------|---------|------|---------|---------|----------|
| INVMSTG1TR | 1.2KB | 25 | 發票主檔轉換控制程式 | 中 | 未開始 |
| FROMMER | 3.7KB | 79 | 特殊控制程式 | 高 | 未開始 |
| ARD001P | 370B | 15 | 特殊控制程式 | 低 | 未開始 |

## 規格書完成進度

| 程式分類 | 總數量 | 未開始 | 進行中 | 已完成 | 已更新 | 完成率 |
|---------|-------|-------|-------|-------|-------|-------|
| ARP系列 (列印相關) | 625 | 625 | 0 | 0 | 0 | 0% |
| ARR系列 (報表產生) | 477 | 477 | 0 | 0 | 0 | 0% |
| ARE系列 (編輯處理) | 130 | 130 | 0 | 0 | 0 | 0% |
| CNV系列 (資料轉換) | 45 | 45 | 0 | 0 | 0 | 0% |
| ARS系列 (處理程式) | 28 | 28 | 0 | 0 | 0 | 0% |
| 其他系列 | 39 | 39 | 0 | 0 | 0 | 0% |
| **總計** | **1344** | **1344** | **0** | **0** | **0** | **0%** |

## CL程式系列統計

| CL程式系列 | 基本程式數量 | 含修訂版總數 | 百分比 | 需撰寫規格書數量 |
|---------|------------|------------|-------|-----------------|
| ARP系列 (列印相關) | 估計270 | 625 | 46.5% | 625 |
| ARR系列 (報表產生) | 估計210 | 477 | 35.5% | 477 |
| ARE系列 (編輯處理) | 估計60 | 130 | 9.7% | 130 |
| CNV系列 (資料轉換) | 估計20 | 45 | 3.3% | 45 |
| ARS系列 (處理程式) | 估計15 | 28 | 2.1% | 28 |
| 其他系列 | 估計21 | 39 | 2.9% | 39 |
| **總計** | **估計596** | **1344** | **100%** | **1344** |

## CL程式特點

### 1. 程式呼叫控制
東鋼應收帳款系統的CL程式在程式呼叫控制方面具有以下特點：
- 負責建立執行環境與參數傳遞
- 處理程式間的執行順序與流程控制
- 設定環境變數與工作參數
- 管理程式間的錯誤處理與恢復機制

### 2. 檔案處理
系統中CL程式在檔案處理方面具有以下特點：
- 進行檔案開啟、關閉及狀態檢查
- 管理檔案共享與鎖定
- 控制臨時檔案的建立與刪除
- 進行簡單的檔案操作如複製與重命名

### 3. 批次處理控制
系統的CL程式在批次處理方面具有以下特點：
- 啟動並監控批次作業
- 設定批次執行參數與優先順序
- 處理批次作業的提交與排程
- 整合一系列相關作業成為完整處理流程

### 4. 系統資源管理
系統的CL程式在系統資源管理方面具有以下特點：
- 設定記憶體與處理資源配置
- 管理印表機與輸出裝置
- 控制作業列隊與執行環境
- 監控系統狀態與資源使用

## 備註
1. 此清單根據QCLSRC_ARLIB資料夾內的檔案統計製作
2. 實際統計到的CL程式檔案數量為1344個，遠超過原先預估的53個
3. 修訂版檔案（含@或#標記）佔總數的55.7%
4. CL程式主要負責呼叫RPG程式及設定執行環境
5. ARP和ARR系列程式合計佔總數的82%，反映系統主要功能集中在列印和報表產生
6. 所有CL程式檔案（包括修訂版）均需撰寫規格書，總數為1344個
7. 由於數量龐大，本清單僅列出具代表性的程式，未列出全部檔案
8. 部分程式資訊為估計值，實際數據可能略有差異
9. 規格書撰寫狀態將定期更新，以反映實際專案進度 