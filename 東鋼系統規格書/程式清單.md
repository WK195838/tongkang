# 東鋼應收帳款系統程式清單

## 一、系統架構概述

本程式清單包含東鋼應收帳款系統中的所有程式，主要分為三大類：
1. RPG程式（QRPGSRC_ARLIB）：負責業務邏輯處理
2. 資料描述檔案（QDDSSRC_ARLIB）：定義系統中使用的資料檔案結構
3. 控制語言程式（QCLSRC_ARLIB）：負責程式呼叫、參數傳遞與流程控制

## 二、程式清單明細

### 1. RPG程式 (QRPGSRC_ARLIB)

#### 1.1 應收帳款主要程式 (ARS系列)

| 程式編號 | 程式名稱 | 版本 | 功能描述 | 相關程式 | 使用檔案 |
| -------- | -------- | ---- | -------- | -------- | -------- |
| ARS001R | 電子發票狀態查詢程式 | 1.0 | 電子發票狀態查詢及列印程式 | ARS001P | INEMST, INVMST, INEMSTG |
| ARS001R@ | 電子發票狀態查詢程式 | 1.1 | 電子發票狀態查詢及列印程式（修訂版） | ARS001P | INEMST, INVMST, INEMSTG |
| ARS001R@1 | 電子發票狀態查詢程式 | 1.2 | 電子發票狀態查詢及列印程式（修訂版） | ARS001P | INEMST, INVMST, INEMSTG |
| ARS001R@2 | 電子發票狀態查詢程式 | 1.3 | 電子發票狀態查詢及列印程式（修訂版） | ARS001P | INEMST, INVMST, INEMSTG |
| ARS002R | 應收帳款處理程式 | 1.0 | 應收帳款相關程式 | ARS002P | TRNDTL |
| ARS201R | 應收帳款處理程式 | 1.0 | 應收帳款相關程式 | ARS201P | TRNDTL |
| ARS202R | 應收帳款處理程式 | 1.0 | 應收帳款相關程式 | ARS202P | TRNDTL |
| ARS202R@ | 應收帳款處理程式 | 1.1 | 應收帳款相關程式（修訂版） | ARS202P | TRNDTL |
| ARS777R | 應收帳款處理程式 | 1.0 | 應收帳款相關程式 | ARS777P | TRNDTL |
| ARS888R | 應收帳款處理程式 | 1.0 | 應收帳款相關程式 | ARS888P | TRNDTL |

#### 1.2 應收帳款報表程式 (ARR系列)

| 程式編號 | 程式名稱 | 版本 | 功能描述 | 相關程式 | 使用檔案 |
| -------- | -------- | ---- | -------- | -------- | -------- |
| ARR136R1 | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR136P | TRNDTL |
| ARR137R | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR137P | TRNDTL |
| ARR138R | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR138P | TRNDTL |
| ARR140R | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR140P | TRNDTL |
| ARR142R | 發票開立狀況統計報表 | 1.0 | 發票開立狀況統計報表 | ARR142P | TRNDTL |
| ARR142RA | 發票開立狀況統計報表子程式 | 1.0 | 發票開立狀況統計報表子程式 | ARR142P | TRNDTL |
| ARR142RB | 發票開立狀況統計報表子程式 | 1.0 | 發票開立狀況統計報表子程式 | ARR142P | TRNDTL |
| ARR143R | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR143P | TRNDTL |
| ARR145R | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR145P | TRNDTL |
| ARR147R | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR147P | TRNDTL |
| ARR150R | 應收帳款報表程式 | 1.0 | 應收帳款報表程式 | ARR150P | TRNDTL |

#### 1.3 資料轉換程式 (CNV系列)

| 程式編號 | 程式名稱 | 版本 | 功能描述 | 相關程式 | 使用檔案 |
| -------- | -------- | ---- | -------- | -------- | -------- |
| CNV002R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV002P | TRNDTL |
| CNV004R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV004P | TRNDTL |
| CNV005R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV005P | TRNDTL |
| CNV006R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV006P | TRNDTL |
| CNV007R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV007P | TRNDTL |
| CNV013R | 資料轉換程式 | 1.0 | 資料轉換程式的主要版本 | CNV013P | TRNDTL |
| CNV014R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV014P | TRNDTL |
| CNV030R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV030P | TRNDTL |
| CNV031R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV031P | TRNDTL |
| CNV032R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV032P | TRNDTL |
| CNV035R | 資料轉換程式 | 1.0 | 資料轉換程式 | CNV035P | TRNDTL |
| CNV050R | 資料轉換程式 | 1.0 | 資料轉換程式 | - | TRNDTL |
| CNVARBTAXR | 稅務相關轉換程式 | 1.0 | 稅務相關轉換程式 | CNVARBTAX | TRNDTL |

#### 1.4 其他轉換程式

| 程式編號 | 程式名稱 | 版本 | 功能描述 | 相關程式 | 使用檔案 |
| -------- | -------- | ---- | -------- | -------- | -------- |
| INVMSTG1R | 發票主檔轉換程式 | 1.0 | 發票主檔轉換程式 | INVMSTG1TR | INVMST |
| RCVDTLCVTR | 收據明細轉換程式 | 1.0 | 收據明細轉換程式 | - | RCVDTL |
| SARCVFCVTR | 銷售收據轉換程式 | 1.0 | 銷售收據轉換程式 | - | SARCVF |
| TREXPTCVTR | 交易匯出轉換程式 | 1.0 | 交易匯出轉換程式 | - | TREXPT |

### 2. 資料描述檔案 (QDDSSRC_ARLIB)

#### 2.1 主要資料檔案

| 檔案名稱 | 檔案類型 | 檔案用途 | 主要欄位 | 相關程式 |
| -------- | -------- | -------- | -------- | -------- |
| TRNDTL | 實體檔案 | 交易明細主檔 | TXNO, TXCODE, TXDATE | ARR系列, CNV系列 |
| TRNDTLG | 實體檔案 | 交易明細相關檔案 | - | ARR系列 |
| TRNDTLN | 實體檔案 | 交易明細相關檔案 | - | ARR系列 |
| TRNDA6 | 實體檔案 | 交易明細相關檔案 | - | ARR系列 |
| TREXPT | 實體檔案 | 交易匯出檔案 | - | TREXPTCVTR |
| SARCVF | 實體檔案 | 銷售收據主檔 | - | SARCVFCVTR |
| RCVWF | 實體檔案 | 收據相關檔案 | - | RCVDTLCVTR |
| UENMST | 實體檔案 | 統一發票主檔 | - | ARS001R |
| UENDTL | 實體檔案 | 統一發票明細檔 | - | ARS001R |

#### 2.2 邏輯檔案與索引檔案

| 檔案名稱 | 檔案類型 | 檔案用途 | 基於檔案 | 索引欄位 |
| -------- | -------- | -------- | -------- | -------- |
| TRNDTLL系列 | 邏輯檔案 | 交易明細的邏輯檔 | TRNDTL | 不同索引組合 |
| RCVDTLL系列 | 邏輯檔案 | 收據明細的邏輯檔 | RCVDTL | 不同索引組合 |
| SARVORL系列 | 邏輯檔案 | 銷售收據的邏輯檔 | SARVOR | 不同索引組合 |
| SARVINL系列 | 邏輯檔案 | 銷售發票的邏輯檔 | SARVIN | 不同索引組合 |

#### 2.3 工作檔案

| 檔案名稱 | 檔案類型 | 檔案用途 | 使用程式 |
| -------- | -------- | -------- | -------- |
| WMST | 工作檔案 | 暫存工作資料 | 多支程式 |
| W1STWF | 工作檔案 | 暫存工作資料 | 多支程式 |
| W2STWF | 工作檔案 | 暫存工作資料 | 多支程式 |
| WTMASPJ1 | 工作檔案 | 暫存工作資料 | 多支程式 |

### 3. 控制語言程式 (QCLSRC_ARLIB)

#### 3.1 應收帳款控制程式 (ARS系列)

| 程式編號 | 程式名稱 | 功能描述 | 呼叫程式 |
| -------- | -------- | -------- | -------- |
| ARS000P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS010P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS020P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS021P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS030P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS040P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS050P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS051P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS060P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS080P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS090P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS100P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS110P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS120P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS121P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS130P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS140P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS150P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS160P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS170P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS180P | 應收帳款程式控制 | 應收帳款程式控制 | - |
| ARS777P | 應收帳款程式控制 | 應收帳款程式控制 | ARS777R |
| ARS888P | 應收帳款程式控制 | 應收帳款程式控制 | ARS888R |
| ARS999P | 應收帳款程式控制 | 應收帳款程式控制 | - |

#### 3.2 應收帳款報表控制程式 (ARR系列)

| 程式編號 | 程式名稱 | 功能描述 | 呼叫程式 |
| -------- | -------- | -------- | -------- |
| ARR135P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | - |
| ARR136P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR136R1 |
| ARR137P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR137R |
| ARR138P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR138R |
| ARR140P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR140R |
| ARR142P | 發票開立狀況統計報表控制程式 | 發票開立狀況統計報表控制程式 | ARR142R, ARR142RA, ARR142RB |
| ARR143P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR143R |
| ARR145P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR145R |
| ARR147P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR147R |
| ARR150P | 應收帳款報表控制程式 | 應收帳款報表控制程式 | ARR150R |

#### 3.3 資料轉換控制程式 (CNV系列)

| 程式編號 | 程式名稱 | 功能描述 | 呼叫程式 |
| -------- | -------- | -------- | -------- |
| CNV001P | 資料轉換控制程式 | 資料轉換控制程式 | - |
| CNV002P | 資料轉換控制程式 | 資料轉換控制程式 | CNV002R |
| CNV003P | 資料轉換控制程式 | 資料轉換控制程式 | - |
| CNV004P | 資料轉換控制程式 | 資料轉換控制程式 | CNV004R |
| CNV005P | 資料轉換控制程式 | 資料轉換控制程式 | CNV005R |
| CNV006P | 資料轉換控制程式 | 資料轉換控制程式 | CNV006R |
| CNV007P | 資料轉換控制程式 | 資料轉換控制程式 | CNV007R |
| CNV008P | 資料轉換控制程式 | 資料轉換控制程式 | - |
| CNV009P | 資料轉換控制程式 | 資料轉換控制程式 | - |
| CNV013P | 資料轉換控制程式 | 資料轉換控制程式 | CNV013R系列 |
| CNV014P | 資料轉換控制程式 | 資料轉換控制程式 | CNV014R |
| CNV015P | 資料轉換控制程式 | 資料轉換控制程式 | - |
| CNV030P | 資料轉換控制程式 | 資料轉換控制程式 | CNV030R系列 |
| CNV031P | 資料轉換控制程式 | 資料轉換控制程式 | CNV031R系列 |
| CNV035P | 資料轉換控制程式 | 資料轉換控制程式 | CNV035R |
| CNVARBTAX | 稅務相關轉換控制程式 | 稅務相關轉換控制程式 | CNVARBTAXR |

#### 3.4 其他控制程式

| 程式編號 | 程式名稱 | 功能描述 | 呼叫程式 |
| -------- | -------- | -------- | -------- |
| INVMSTG1TR | 發票主檔轉換控制程式 | 發票主檔轉換控制程式 | INVMSTG1R |
| FROMMER | 特殊控制程式 | 特殊控制程式 | - |

## 三、程式關聯圖

### 1. ARS系列程式關聯
ARS001P → ARS001R
ARS002P → ARS002R
...

### 2. ARR系列程式關聯
ARR142P → ARR142R
ARR142P → ARR142RA
ARR142P → ARR142RB
...

### 3. CNV系列程式關聯
CNV013P → CNV013R
CNV030P → CNV030R
... 