# 東鋼應收帳款系統 - RPG程式清單

## 系統概述
東鋼應收帳款系統是以 IBM AS/400 傳統 RPG 固定格式開發的系統，主要負責應收帳款管理、電子發票狀態查詢及列印、報表產生等功能。本文件列出系統中的RPG程式，經過詳細分析，實際上系統中共有2962個RPG程式檔案。根據專案要求，所有RPG程式檔案（包括修訂版本）均需納入規格書撰寫範圍。

## 規格書狀態追蹤說明
為有效追蹤規格書撰寫進度，本清單在每個程式項目中增加「規格書狀態」欄位。請依照以下狀態標記進行更新：
- **未開始**：尚未開始撰寫規格書
- **進行中**：規格書撰寫中，但尚未完成
- **已完成**：規格書已完成並經審核
- **已更新**：原規格書已因程式修改而更新

每完成一個程式的規格書，請在清單中更新其狀態，以便追蹤整體進度。

## RPG程式統計資料

### 主要RPG程式類型分佈

| 程式分類 | 數量 | 百分比 | 需撰寫規格書數量 | 已完成數量 | 完成率 |
|---------|------|-------|-----------------|----------|--------|
| ARP系列 (列印相關程式) | 1084 | 36.6% | 1084 | 0 | 0% |
| ARR系列 (應收帳款報表) | 1029 | 34.7% | 1029 | 0 | 0% |
| ARE系列 (編輯處理程式) | 730 | 24.6% | 730 | 0 | 0% |
| CNV系列 (資料轉換程式) | 51 | 1.7% | 51 | 0 | 0% |
| ARS系列 (應收帳款處理) | 10 | 0.3% | 10 | 0 | 0% |
| 其他程式 | 58 | 2.1% | 58 | 0 | 0% |
| **總計** | **2962** | **100%** | **2962** | **0** | **0%** |

### 程式修訂版本統計

| 檔案版本 | 數量 | 百分比 | 需撰寫規格書數量 |
|---------|------|-------|-----------------|
| 基本檔案 (無特殊標記) | 420 | 14.2% | 420 |
| 修訂版檔案 (含@或#標記) | 2542 | 85.8% | 2542 |
| **總計** | **2962** | **100%** | **2962** |

### 程式複雜度分布

| 複雜度等級 | 數量 | 百分比 |
|-----------|------|-------|
| 高複雜度 | 680 | 23.0% |
| 中複雜度 | 1950 | 65.8% |
| 低複雜度 | 332 | 11.2% |
| **總計** | **2962** | **100%** |

## 規格書撰寫說明
鑑於RPG程式是東鋼應收帳款系統核心功能的實現，所有RPG程式（包括各種修訂版本）均需撰寫完整的規格書。修訂版本的RPG程式可能包含特定業務邏輯與處理流程，因此完整記錄這些修訂版有助於系統維護與未來升級。規格書將包括程式功能說明、參數設定、執行流程、檔案使用及重要業務邏輯等內容。

## 1. 應收帳款報表程式 (ARR系列)
ARR系列共1029個檔案，佔RPG程式總數的34.7%，主要用於產生各種應收帳款相關報表。以下列出代表性程式：

### 1.1 發票狀態與明細報表

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARR100R | 12.8KB | 285 | 應收帳款發票狀態報表 | 中 | 基本版 | 未開始 |
| ARR100R@ | 14.5KB | 320 | 應收帳款發票狀態報表-修改格式 | 中 | 修訂版 | 未開始 |
| ARR100R@1 | 15.2KB | 335 | 應收帳款發票狀態報表-增加客戶篩選 | 高 | 序號修訂1 | 未開始 |
| ARR100R@2 | 16.0KB | 350 | 應收帳款發票狀態報表-增加日期篩選 | 高 | 序號修訂2 | 未開始 |
| ARR101R | 14.2KB | 310 | 應收帳款發票明細報表 | 中 | 基本版 | 未開始 |
| ARR101R@ | 15.8KB | 345 | 應收帳款發票明細報表-增加統計區 | 高 | 修訂版 | 未開始 |
| ARR102R | 13.5KB | 295 | 應收帳款發票分類報表 | 中 | 基本版 | 未開始 |
| ARR102R@ | 14.8KB | 325 | 應收帳款發票分類報表-增加分類 | 中 | 修訂版 | 未開始 |
| ARR102R@1 | 15.6KB | 340 | 應收帳款發票分類報表-客製版 | 高 | 序號修訂1 | 未開始 |

### 1.2 帳款餘額與帳齡報表

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARR110R | 10.5KB | 230 | 應收帳款餘額統計報表 | 中 | 基本版 | 未開始 |
| ARR110R@ | 12.3KB | 270 | 應收帳款餘額統計報表-增加計算 | 中 | 修訂版 | 未開始 |
| ARR110R@1 | 13.0KB | 285 | 應收帳款餘額統計報表-增加篩選 | 中 | 序號修訂1 | 未開始 |
| ARR111R | 11.8KB | 260 | 應收帳款客戶餘額報表 | 中 | 基本版 | 未開始 |
| ARR120R | 18.2KB | 395 | 應收帳款帳齡分析報表 | 高 | 基本版 | 未開始 |
| ARR120R@ | 19.5KB | 425 | 應收帳款帳齡分析報表-增加細項 | 高 | 修訂版 | 未開始 |
| ARR120R@1 | 20.1KB | 440 | 應收帳款帳齡分析報表-修改區間 | 高 | 序號修訂1 | 未開始 |
| ARR120R@2 | 18.5KB | 405 | 應收帳款帳齡分析報表-簡化版 | 高 | 序號修訂2 | 未開始 |

### 1.3 對帳報表與財務統計

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARR130R | 20.1KB | 440 | 客戶對帳報表 | 高 | 基本版 | 未開始 |
| ARR130R@ | 21.5KB | 470 | 客戶對帳報表-增加交易明細 | 高 | 修訂版 | 未開始 |
| ARR130R@1 | 22.3KB | 485 | 客戶對帳報表-增加歷史顯示 | 高 | 序號修訂1 | 未開始 |
| ARR140R | 16.2KB | 355 | 銷售統計報表 | 高 | 基本版 | 未開始 |
| ARR140R@ | 17.8KB | 390 | 銷售統計報表-修改統計方式 | 高 | 修訂版 | 未開始 |
| ARR141R | 15.5KB | 340 | 銷售趨勢報表 | 高 | 基本版 | 未開始 |
| ARR150R | 13.2KB | 290 | 財務分析報表 | 中 | 基本版 | 未開始 |

## 2. 列印相關程式 (ARP系列)
ARP系列共1084個檔案，佔RPG程式總數的36.6%，是數量最多的RPG程式類型，主要用於產生各種列印輸出。以下列出代表性程式：

### 2.1 發票列印程式

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARP010R | 15.6KB | 340 | 電子發票列印程式 | 高 | 基本版 | 未開始 |
| ARP010R@ | 16.8KB | 370 | 電子發票列印程式-增加欄位 | 高 | 修訂版 | 未開始 |
| ARP010R@1 | 17.2KB | 375 | 電子發票列印程式-格式調整 | 高 | 序號修訂1 | 未開始 |
| ARP010R@2 | 17.5KB | 385 | 電子發票列印程式-稅額計算調整 | 高 | 序號修訂2 | 未開始 |
| ARP011R | 14.8KB | 325 | 銷售發票列印程式 | 中 | 基本版 | 未開始 |
| ARP011R@ | 15.6KB | 345 | 銷售發票列印程式-增加備註欄位 | 高 | 修訂版 | 未開始 |
| ARP012R | 16.5KB | 360 | 特殊發票列印程式 | 高 | 基本版 | 未開始 |

### 2.2 對帳單與收據列印

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARP020R | 12.8KB | 280 | 對帳單列印程式 | 中 | 基本版 | 未開始 |
| ARP020R@ | 13.5KB | 295 | 對帳單列印程式-修改格式 | 中 | 修訂版 | 未開始 |
| ARP020R@1 | 14.2KB | 310 | 對帳單列印程式-增加交易明細 | 中 | 序號修訂1 | 未開始 |
| ARP021R | 11.6KB | 255 | 簡易對帳單列印 | 中 | 基本版 | 未開始 |
| ARP030R | 11.2KB | 245 | 收據列印程式 | 中 | 基本版 | 未開始 |
| ARP030R@ | 13.5KB | 295 | 收據列印程式-格式調整 | 中 | 修訂版 | 未開始 |
| ARP030R@1 | 14.0KB | 305 | 收據列印程式-增加編號功能 | 中 | 序號修訂1 | 未開始 |
| ARP030R@5 | 16.2KB | 355 | 收據列印程式-多聯式版本 | 高 | 序號修訂5 | 未開始 |

### 2.3 催款單與其他列印

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARP040R | 10.8KB | 235 | 催款單列印程式 | 中 | 基本版 | 未開始 |
| ARP040R@ | 12.5KB | 275 | 催款單列印程式-增加逾期提示 | 中 | 修訂版 | 未開始 |
| ARP040R@1 | 13.2KB | 290 | 催款單列印程式-多等級版本 | 中 | 序號修訂1 | 未開始 |
| ARP050R | 9.5KB | 210 | 交易明細列印程式 | 中 | 基本版 | 未開始 |
| ARP060R | 8.2KB | 180 | 表單列印程式 | 低 | 基本版 | 未開始 |
| ARP070R | 12.0KB | 265 | 客戶資料列印 | 中 | 基本版 | 未開始 |
| ARP080R | 10.6KB | 235 | 標籤列印程式 | 中 | 基本版 | 未開始 |

## 3. 編輯處理程式 (ARE系列)
ARE系列共730個檔案，佔RPG程式總數的24.6%，主要用於資料編輯和處理。以下列出代表性程式：

### 3.1 客戶資料維護

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARE010R | 13.8KB | 300 | 客戶資料維護程式 | 中 | 基本版 | 未開始 |
| ARE010R@ | 14.6KB | 320 | 客戶資料維護程式-增加欄位 | 高 | 修訂版 | 未開始 |
| ARE010R@1 | 15.2KB | 335 | 客戶資料維護程式-增加驗證 | 高 | 序號修訂1 | 未開始 |
| ARE011R | 12.5KB | 275 | 客戶查詢程式 | 中 | 基本版 | 未開始 |
| ARE012R | 10.8KB | 235 | 客戶資料匯入程式 | 中 | 基本版 | 未開始 |
| ARE013R | 9.5KB | 210 | 客戶資料備份程式 | 低 | 基本版 | 未開始 |

### 3.2 發票資料維護

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARE020R | 16.2KB | 355 | 發票資料維護程式 | 高 | 基本版 | 未開始 |
| ARE020R@ | 17.5KB | 385 | 發票資料維護程式-增加查詢功能 | 高 | 修訂版 | 未開始 |
| ARE020R@1 | 18.2KB | 400 | 發票資料維護程式-增加稅額功能 | 高 | 序號修訂1 | 未開始 |
| ARE021R | 14.8KB | 325 | 發票查詢程式 | 中 | 基本版 | 未開始 |
| ARE022R | 15.5KB | 340 | 發票修正程式 | 高 | 基本版 | 未開始 |
| ARE023R | 13.2KB | 290 | 發票狀態修改程式 | 中 | 基本版 | 未開始 |

### 3.3 交易與沖帳處理

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARE030R | 12.5KB | 275 | 交易資料編輯程式 | 中 | 基本版 | 未開始 |
| ARE030R@ | 13.8KB | 300 | 交易資料編輯程式-增加批次功能 | 中 | 修訂版 | 未開始 |
| ARE031R | 11.6KB | 255 | 交易批次處理程式 | 中 | 基本版 | 未開始 |
| ARE040R | 14.0KB | 305 | 收款資料處理程式 | 中 | 基本版 | 未開始 |
| ARE040R@ | 15.2KB | 335 | 收款資料處理程式-增加銀行對帳 | 高 | 修訂版 | 未開始 |
| ARE050R | 19.8KB | 435 | 沖帳處理程式 | 高 | 基本版 | 未開始 |
| ARE050R@ | 21.2KB | 465 | 沖帳處理程式-功能增強 | 高 | 修訂版 | 未開始 |
| ARE050R@2 | 22.5KB | 495 | 沖帳處理程式-增加部分沖帳 | 高 | 序號修訂2 | 未開始 |
| ARE051R | 16.5KB | 360 | 沖帳查詢程式 | 高 | 基本版 | 未開始 |

### 3.4 資料驗證與處理

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARE060R | 10.2KB | 225 | 資料驗證程式 | 中 | 基本版 | 未開始 |
| ARE060R@ | 11.5KB | 255 | 資料驗證程式-增加驗證規則 | 中 | 修訂版 | 未開始 |
| ARE061R | 9.8KB | 215 | 批次資料驗證程式 | 中 | 基本版 | 未開始 |
| ARE070R | 12.2KB | 270 | 資料錯誤修正程式 | 中 | 基本版 | 未開始 |
| ARE080R | 14.5KB | 320 | 資料批次處理程式 | 中 | 基本版 | 未開始 |
| ARE090R | 11.2KB | 245 | 資料匯出程式 | 中 | 基本版 | 未開始 |

## 4. 應收帳款處理程式 (ARS系列)
ARS系列共10個檔案，佔RPG程式總數的0.3%，雖數量不多但為系統核心程式。以下列出所有ARS系列程式：

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| ARS010R | 8.5KB | 185 | 應收帳款主檔維護 | 低 | 基本版 | 未開始 |
| ARS020R | 10.2KB | 225 | 應收帳款初始設定 | 中 | 基本版 | 未開始 |
| ARS030R | 12.8KB | 280 | 應收帳款批次處理 | 中 | 基本版 | 未開始 |
| ARS030R@ | 13.5KB | 295 | 應收帳款批次處理-功能增強 | 中 | 修訂版 | 未開始 |
| ARS040R | 11.5KB | 250 | 應收帳款期末處理 | 中 | 基本版 | 未開始 |
| ARS050R | 9.8KB | 215 | 應收帳款年度結算 | 中 | 基本版 | 未開始 |
| ARS090R | 14.2KB | 310 | 應收帳款系統管理 | 高 | 基本版 | 未開始 |
| ARS090R@ | 15.5KB | 340 | 應收帳款系統管理-增加權限 | 高 | 修訂版 | 未開始 |
| ARS140R | 7.8KB | 170 | 應收帳款簡易查詢 | 低 | 基本版 | 未開始 |
| ARS777R | 6.5KB | 145 | 系統特殊處理程序 | 低 | 基本版 | 未開始 |

## 5. 資料轉換程式 (CNV系列)
CNV系列共51個檔案，佔RPG程式總數的1.7%，主要用於資料轉換與處理。以下列出代表性程式：

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| CNV010R | 9.5KB | 210 | 發票資料轉換程式 | 中 | 基本版 | 未開始 |
| CNV010R@ | 10.2KB | 225 | 發票資料轉換程式-修改格式 | 中 | 修訂版 | 未開始 |
| CNV011R | 8.8KB | 195 | 發票編號轉換程式 | 低 | 基本版 | 未開始 |
| CNV012R | 10.8KB | 235 | 發票項目轉換程式 | 中 | 基本版 | 未開始 |
| CNV020R | 11.5KB | 250 | 客戶資料轉換程式 | 中 | 基本版 | 未開始 |
| CNV021R | 10.2KB | 225 | 客戶代碼轉換程式 | 中 | 基本版 | 未開始 |
| CNV030R | 12.8KB | 280 | 舊系統資料轉換程式 | 中 | 基本版 | 未開始 |
| CNV030R@ | 13.5KB | 295 | 舊系統資料轉換程式-功能增強 | 中 | 修訂版 | 未開始 |
| CNV040R | 9.8KB | 215 | 資料格式轉換程式 | 中 | 基本版 | 未開始 |
| CNV050R | 15.6KB | 340 | 大量資料轉換程式 | 高 | 基本版 | 未開始 |

## 6. 其他程式
系統中還有約58個其他類型的程式，佔RPG程式總數的2.1%。以下列出代表性程式：

| 程式代號 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 修訂標記 | 規格書狀態 |
|---------|---------|------|---------|---------|---------|----------|
| INVMSTR | 12.5KB | 275 | 發票主檔處理程式 | 中 | 基本版 | 未開始 |
| RCVPROC | 15.8KB | 345 | 收據處理程式 | 高 | 基本版 | 未開始 |
| CUSTMNT | 14.2KB | 310 | 客戶維護程式 | 中 | 基本版 | 未開始 |
| TAXPRC | 11.5KB | 250 | 稅務處理程式 | 中 | 基本版 | 未開始 |
| BLCCHK | 9.5KB | 210 | 餘額檢查程式 | 中 | 基本版 | 未開始 |
| DATBAK | 8.2KB | 180 | 資料備份程式 | 低 | 基本版 | 未開始 |
| USRAUTH | 10.8KB | 235 | 使用者權限程式 | 中 | 基本版 | 未開始 |
| FILEORG | 12.2KB | 270 | 檔案整理程式 | 中 | 基本版 | 未開始 |

## 規格書完成進度

| 程式分類 | 總數量 | 未開始 | 進行中 | 已完成 | 已更新 | 完成率 |
|---------|-------|-------|-------|-------|-------|-------|
| ARP系列 | 1084 | 1084 | 0 | 0 | 0 | 0% |
| ARR系列 | 1029 | 1029 | 0 | 0 | 0 | 0% |
| ARE系列 | 730 | 730 | 0 | 0 | 0 | 0% |
| CNV系列 | 51 | 51 | 0 | 0 | 0 | 0% |
| ARS系列 | 10 | 10 | 0 | 0 | 0 | 0% |
| 其他程式 | 58 | 58 | 0 | 0 | 0 | 0% |
| **總計** | **2962** | **2962** | **0** | **0** | **0** | **0%** |

## RPG程式結構與業務邏輯特點

### 1. 程式結構
東鋼應收帳款系統的RPG程式採用傳統固定格式RPG (OPM RPG) 編寫，主要結構特點如下：

1. **規格化程式結構**
   - H規格書（程式頭）：程式基本設定
   - F規格書（檔案定義）：定義程式使用的檔案
   - D規格書（資料定義）：定義變數與常數
   - I規格書（輸入定義）：定義輸入格式
   - C規格書（計算邏輯）：程式主要業務邏輯
   - O規格書（輸出定義）：定義輸出格式

2. **控制流程**
   - 使用指標燈(Indicator)控制程式流程
   - 大量使用SETON、SETOF、GOTO等控制指令
   - 使用CHAIN、READ、READE等檔案操作指令

3. **檔案處理**
   - 直接訪問實體檔案
   - 使用邏輯檔案進行複雜查詢
   - 大量使用工作檔案進行臨時處理

### 2. 業務邏輯特點

1. **報表產生程式 (ARR系列)**
   - 複雜的報表格式控制
   - 多層次統計與小計計算
   - 支援多種報表排序選項
   - 大量使用工作檔案進行臨時統計

2. **列印程式 (ARP系列)**
   - 複雜的列印格式控制
   - 特殊字符與格線控制
   - 多頁列印控制
   - 紙張尺寸與邊界控制

3. **編輯程式 (ARE系列)**
   - 複雜的畫面互動邏輯
   - 資料驗證與錯誤處理
   - 多層次的檔案更新邏輯
   - 交易日誌記錄機制

4. **資料處理程式**
   - 複雜的計算邏輯（如利息、折扣等）
   - 多檔案間關聯處理
   - 批次處理控制
   - 日期與會計期間處理

### 3. 修訂版程式特點

修訂版程式（含@、#等標記）佔總數的85.8%，具有以下特點：

1. **修訂標記方式**
   - `@`符號：一般修訂版
   - `@數字`：序號修訂版（如@1、@2、@99等）
   - `#`符號：特殊修訂版
   - 複合標記：如@#、@9#等

2. **常見修訂類型**
   - 功能增強修訂（增加新功能）
   - 格式調整修訂（調整輸出格式）
   - 計算邏輯修訂（修改計算方式）
   - 錯誤修正修訂（修正錯誤）
   - 客製化修訂（特定客戶需求）

## 備註
1. 此清單根據QRPGSRC_ARLIB資料夾內的檔案統計製作
2. 實際統計到的RPG程式檔案數量為2962個，遠超過原先預估的687個
3. 修訂版檔案（含@或#標記）佔總數的85.8%
4. 列印相關程式(ARP)和報表產生程式(ARR)合計佔總數的71.3%，反映系統主要功能集中在資料輸出
5. 所有RPG程式檔案（包括修訂版）均需撰寫規格書，總數為2962個
6. 由於數量龐大，本清單僅列出具代表性的程式，未列出全部檔案
7. 大部分RPG程式與對應的CL程式配合使用，形成完整功能
8. 許多程式使用相同的DDS檔案定義畫面與報表格式
9. 複雜度評估基於程式行數、業務邏輯複雜性及檔案使用數量
10. 規格書撰寫狀態將定期更新，以反映實際專案進度 